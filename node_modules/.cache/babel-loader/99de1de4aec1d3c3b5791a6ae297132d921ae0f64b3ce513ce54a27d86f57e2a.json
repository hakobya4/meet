{"ast":null,"code":"import _regeneratorRuntime from\"/Users/karenhakobyan/Desktop/meet/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/karenhakobyan/Desktop/meet/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _toConsumableArray from\"/Users/karenhakobyan/Desktop/meet/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";var _ref,_ref2,_ref3,_ref4;// src/api.js\nimport mockData from'./mock-data';/**\n *\n * @param {*} events:\n * The following function should be in the “api.js” file.\n * This function takes an events array, then uses map to create a new array with only locations.\n * It will also remove all duplicates by creating another new array using the spread operator and spreading a Set.\n * The Set will remove all duplicates from the array.\n */export var extractLocations=function extractLocations(events){var extractedLocations=events.map(function(event){return event.location;});var locations=_toConsumableArray(new Set(extractedLocations));return locations;};/**\n *\n * This function will fetch the list of all events\n */export var getEvents=function getEvents(){return(_ref=_ref||_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var token,url,response,result;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!window.location.href.startsWith(\"http://localhost\")){_context.next=2;break;}return _context.abrupt(\"return\",mockData);case 2:_context.next=4;return getAccessToken();case 4:token=_context.sent;if(!token){_context.next=19;break;}removeQuery();url=\"https://w8wdtyx119.execute-api.eu-central-1.amazonaws.com/dev/api/get-events\"+\"/\"+token;_context.next=10;return fetch(url);case 10:response=_context.sent;_context.next=13;return response.json();case 13:result=_context.sent;if(!result){_context.next=18;break;}return _context.abrupt(\"return\",result.events);case 18:return _context.abrupt(\"return\",null);case 19:case\"end\":return _context.stop();}},_callee);}))).apply(this,arguments);};export var getAccessToken=function getAccessToken(){return(_ref2=_ref2||_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var accessToken,tokenCheck,searchParams,code,response,result,authUrl;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:accessToken=localStorage.getItem('access_token');_context2.t0=accessToken;if(!_context2.t0){_context2.next=6;break;}_context2.next=5;return checkToken(accessToken);case 5:_context2.t0=_context2.sent;case 6:tokenCheck=_context2.t0;if(!(!accessToken||tokenCheck.error)){_context2.next=24;break;}_context2.next=10;return localStorage.removeItem(\"access_token\");case 10:searchParams=new URLSearchParams(window.location.search);_context2.next=13;return searchParams.get(\"code\");case 13:code=_context2.sent;if(code){_context2.next=23;break;}_context2.next=17;return fetch(\"https://w8wdtyx119.execute-api.eu-central-1.amazonaws.com/dev/api/get-auth-url\");case 17:response=_context2.sent;_context2.next=20;return response.json();case 20:result=_context2.sent;authUrl=result.authUrl;return _context2.abrupt(\"return\",window.location.href=authUrl);case 23:return _context2.abrupt(\"return\",code&&getToken(code));case 24:return _context2.abrupt(\"return\",accessToken);case 25:case\"end\":return _context2.stop();}},_callee2);}))).apply(this,arguments);};var removeQuery=function removeQuery(){var newurl;if(window.history.pushState&&window.location.pathname){newurl=window.location.protocol+\"//\"+window.location.host+window.location.pathname;window.history.pushState(\"\",\"\",newurl);}else{newurl=window.location.protocol+\"//\"+window.location.host;window.history.pushState(\"\",\"\",newurl);}};var getToken=function getToken(_x){return(_ref3=_ref3||_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(code){var encodeCode,response,_yield$response$json,access_token;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:encodeCode=encodeURIComponent(code);_context3.next=3;return fetch('https://w8wdtyx119.execute-api.eu-central-1.amazonaws.com/dev/api/token'+'/'+encodeCode);case 3:response=_context3.sent;_context3.next=6;return response.json();case 6:_yield$response$json=_context3.sent;access_token=_yield$response$json.access_token;access_token&&localStorage.setItem(\"access_token\",access_token);return _context3.abrupt(\"return\",access_token);case 10:case\"end\":return _context3.stop();}},_callee3);}))).apply(this,arguments);};var checkToken=function checkToken(_x2){return(_ref4=_ref4||_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(accessToken){var response,result;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:_context4.next=2;return fetch(\"https://www.googleapis.com/oauth2/v1/tokeninfo?access_token=\".concat(accessToken));case 2:response=_context4.sent;_context4.next=5;return response.json();case 5:result=_context4.sent;return _context4.abrupt(\"return\",result);case 7:case\"end\":return _context4.stop();}},_callee4);}))).apply(this,arguments);};","map":{"version":3,"names":["mockData","extractLocations","events","extractedLocations","map","event","location","locations","_toConsumableArray","Set","getEvents","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","token","url","response","result","wrap","_callee$","_context","prev","next","window","href","startsWith","abrupt","getAccessToken","sent","removeQuery","fetch","json","stop","apply","arguments","_ref2","_callee2","accessToken","tokenCheck","searchParams","code","authUrl","_callee2$","_context2","localStorage","getItem","t0","checkToken","error","removeItem","URLSearchParams","search","get","getToken","newurl","history","pushState","pathname","protocol","host","_x","_ref3","_callee3","encodeCode","_yield$response$json","access_token","_callee3$","_context3","encodeURIComponent","setItem","_x2","_ref4","_callee4","_callee4$","_context4","concat"],"sources":["/Users/karenhakobyan/Desktop/meet/src/api.js"],"sourcesContent":["// src/api.js\n\nimport mockData from './mock-data';\n\n/**\n *\n * @param {*} events:\n * The following function should be in the “api.js” file.\n * This function takes an events array, then uses map to create a new array with only locations.\n * It will also remove all duplicates by creating another new array using the spread operator and spreading a Set.\n * The Set will remove all duplicates from the array.\n */\nexport const extractLocations = (events) => {\n  const extractedLocations = events.map((event) => event.location);\n  const locations = [...new Set(extractedLocations)];\n  return locations;\n};\n\n/**\n *\n * This function will fetch the list of all events\n */\nexport const getEvents = async () => {\n  if (window.location.href.startsWith(\"http://localhost\")) {\n    return mockData;\n  }\n\n  const token = await getAccessToken();\n\n  if (token) {\n    removeQuery();\n    const url =  \"https://w8wdtyx119.execute-api.eu-central-1.amazonaws.com/dev/api/get-events\" + \"/\" + token;\n    const response = await fetch(url);\n    const result = await response.json();\n    if (result) {\n      return result.events;\n    } else return null; \n  }\n};\n\nexport const getAccessToken = async () => {\n  const accessToken = localStorage.getItem('access_token');\n  const tokenCheck = accessToken && (await checkToken(accessToken));\n\n\n  if (!accessToken || tokenCheck.error) {\n    await localStorage.removeItem(\"access_token\");\n    const searchParams = new URLSearchParams(window.location.search);\n    const code = await searchParams.get(\"code\");\n    if (!code) {\n      const response = await fetch(\n        \"https://w8wdtyx119.execute-api.eu-central-1.amazonaws.com/dev/api/get-auth-url\"\n      );\n      const result = await response.json();\n      const { authUrl } = result;\n      return (window.location.href = authUrl);\n    }\n    return code && getToken(code);\n  }\n  return accessToken;\n  \n};\n\nconst removeQuery = () => {\n  let newurl;\n  if (window.history.pushState && window.location.pathname) {\n    newurl =\n      window.location.protocol +\n      \"//\" +\n      window.location.host +\n      window.location.pathname;\n    window.history.pushState(\"\", \"\", newurl);\n  } else {\n    newurl = window.location.protocol + \"//\" + window.location.host;\n    window.history.pushState(\"\", \"\", newurl);\n  }\n};\n\nconst getToken = async (code) => {\n  const encodeCode = encodeURIComponent(code);\n  const response = await fetch(\n    'https://w8wdtyx119.execute-api.eu-central-1.amazonaws.com/dev/api/token' + '/' + encodeCode\n  );\n  const { access_token } = await response.json();\n  access_token && localStorage.setItem(\"access_token\", access_token);\n\n  return access_token;\n};\n\nconst checkToken = async (accessToken) => {\n  const response = await fetch(\n    `https://www.googleapis.com/oauth2/v1/tokeninfo?access_token=${accessToken}`\n  );\n  const result = await response.json();\n  return result;\n};"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}